WITH eval_table AS ( SELECT  20 as seniority,'3-Advanced'as experience,'Technical' as category, 'Issue' as type)
  SELECT *
  FROM ML.PREDICT(MODEL helpdesk.pred, TABLE eval_table)
  
  //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  
  WITH eval_table AS ( SELECT  20 as seniority,'3-Advanced'as experience,'Technical' as category, 'Issue' as type)
  SELECT cast(predicted_label as INT64) as predicted_label
  FROM ML.PREDICT(MODEL helpdesk.pred, TABLE eval_table)
  
    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  
  WITH pred_table AS ( SELECT 5 as seniority, '3-Advanced' as experience, 'Billing' as category, 'Request' as type) 

SELECT *

 FROM ML.PREDICT( MODEL `helpdesk.pred`,TABLE pred_table)
 
 ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
 
 WITH eval_table AS ( SELECT category,seniority,type,experience, resolutiontime as label
FROM `bot-prueba-302619.helpdesk.preguntas`)
SELECT *
FROM ML.EVALUATE(MODEL helpdesk.pred, TABLE eval_table)

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

https://console.cloud.google.com/bigquery?sq=925031520932:79bc43df80d1436a92e3eea5c560dd29
CREATE OR REPLACE MODEL `bot-prueba-302619.helpdesk.pred` OPTIONS(model_type='linear_reg') AS
SELECT 
seniority, experience,type,category,
resolutiontime as label FROM 
`bot-prueba-302619.helpdesk.preguntas`

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

SELECT * FROM `bot-prueba-302619.helpdesk.preguntas` LIMIT 20000

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

CREATE OR REPLACE MODEL `bot-prueba-302619.helpdesk.pred` OPTIONS(model_type='linear_reg') AS
SELECT 
seniority, experience,category, type,resolutiontime as label
FROM 
`bot-prueba-302619.helpdesk.preguntas`
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
https://github.com/sukuzhanay/data-mining-bot/blob/master/index.js
gs://solutions-public-assets/smartenup-helpdesk/ml/issues.csv
